FROM redis:6
# We start from the redis container because I dont wanna mess with the config
# https://github.com/docker-library/redis

RUN apt-get update -qq &&\
    apt-get install -qq curl &&\
    apt-get install -qq --no-install-recommends \
        bash \
        curl \
        ca-certificates \
        git \
        jq \
        redis \
        supervisor \
        tar

COPY tools/exeq/tests/supervisord.conf /etc/supervisord.conf
COPY tools/exeq/tests/sd.redis.conf /etc/supervisord.d/redis.conf

ENTRYPOINT ["supervisord", "--nodaemon", "--configuration", "/etc/supervisord.conf"]
CMD []